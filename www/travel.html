<!DOCTYPE html>
<html>
    <head>
        <title>Travel Distance</title>
        <meta name="viewport" content="user-scalable=yes, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height" />
        <link rel="stylesheet" type='text/css' href="bootstrap/css/bootstrap.css">
        <link rel="stylesheet" type='text/css' href="css/semantic.css">
        <style type="text/css">
            .map {
                width: 100%;
                height: 100%;
                position: absolute;
                top: 0px;
                left: 0px;
                overflow: hidden;
            }
            .over_map {
                position: absolute;
                padding: 10px;
                z-index: 9999;
            }
        </style>
    </head>
    <body>
        <div id="googleMap" class="map"></div>
        <div class="over_map">
            <i id="btnPlay" class="ui icon play circle big green"></i>
            <i id="btnStop" class="ui icon stop circle big red"></i>
        </div>
    </body>
</html>
<script type="text/javascript" src="js/jquery1.11.1-min.js"></script>
<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
<script type="text/javascript" src="js/semantic.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyAvCB0fJALK-4VaEiubgiVYuh-pJxNGvH0&callback=initMap&libraries=geometry" async defer></script>
<script type="text/javascript">
    var coords = [],
        colors = ["#38c6f3", "#4a5ba9", "#ff4864", "#166048", "#291f09", "#800000", "#0000ff", "#ff0000", "#512411", "#e3af0c"];
    var gstartmarkers = [], gendmarkers = [], gtourplans = [], path = [];
    var map, infowindow, startPoint, prevPoint, endPoint, endMarker, prevLatLng, rotation, route, tripPath, flag, i = 0;
    var car = "M17.402,0H5.643C2.526,0,0,3.467,0,6.584v34.804c0,3.116,2.526,5.644,5.643,5.644h11.759c3.116,0,5.644-2.527,5.644-5.644 V6.584C23.044,3.467,20.518,0,17.402,0z M22.057,14.188v11.665l-2.729,0.351v-4.806L22.057,14.188z M20.625,10.773 c-1.016,3.9-2.219,8.51-2.219,8.51H4.638l-2.222-8.51C2.417,10.773,11.3,7.755,20.625,10.773z M3.748,21.713v4.492l-2.73-0.349 V14.502L3.748,21.713z M1.018,37.938V27.579l2.73,0.343v8.196L1.018,37.938z M2.575,40.882l2.218-3.336h13.771l2.219,3.336H2.575z M19.328,35.805v-7.872l2.729-0.355v10.048L19.328,35.805z";
    function initMap() {
        $("#btnStop").hide();
        var mapProp = {
            center: new google.maps.LatLng(14.2599286, 80.1137635),
            zoom: 17,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            panControl: false,
            zoomControl: false,
            scaleControl: false,
            mapTypeControl: false,
            streetViewControl: false,
            overviewMapControl: false,
            rotateControl: false
        };
        map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

        var tourPlan = [
            /*{lat:14.259252, lng:80.114189},
            {lat:14.259355, lng:80.113772},
            {lat:14.259487, lng:80.113226},
            {lat:14.259612, lng:80.112657},
            {lat:14.260274, lng:80.112869},
            {lat:14.261002, lng:80.113067},
            {lat:14.261627, lng:80.113256},
            {lat:14.262274, lng:80.113484},
            {lat:14.262001, lng:80.113947},
            {lat:14.261700, lng:80.114508},
            {lat:14.261509, lng:80.114925},
            {lat:14.261141, lng:80.114834},
            {lat:14.260230, lng:80.114523},
            {lat:14.259818, lng:80.114387},
            {lat:14.259494, lng:80.114296},
            {lat:14.259656, lng:80.113818},
            {lat:14.259855, lng:80.113840}*/
            "14.4456451,79.9830864",
"14.4453303,79.984135",
"14.4464238,79.9844846",
"14.4456451,79.9830864",
"14.4464238,79.9844846",
"14.4449559,79.9837855",
"14.4456451,79.9830864",
"14.4449559,79.9837855",
"14.445105,79.9872809",
"14.4449559,79.9837855",
"14.4456451,79.9830864",
"14.4456451,79.9830864",
"14.4075227,80.0177806",
"14.4456451,79.9830864",
"14.4472473,79.9869314",
"14.4456451,79.9830864",
"14.4459876,79.9875516",
"14.4459317,79.9875372",
"14.4458325,79.9875312",
"14.4458207,79.9875776",
"14.4457408,79.9876132",
"14.4458222,79.9875159",
"14.4458364,79.9874748",
"14.4458481,79.9874679",
"14.4457035,79.9871916",
"14.4462546,79.9875515",
"14.4482008,79.9880972",
"14.4486362,79.9882384",
"14.449664,79.9886041",
"14.4506135,79.9890128",
"14.4510546,79.9892393",
"14.4516693,79.9894803",
"14.4522556,79.989509",
"14.4521901,79.9898633",
"14.4521637,79.9903929",
"14.4521876,79.9904508",
"14.4528268,79.9907502",
"14.4525162,79.9912364",
"14.4527291,79.9915986",
"14.4529537,79.9920329",
"14.4531402,79.9920107",
"14.4531942,79.9923329",
"14.4531179,79.9928369",
"14.4530964,79.9932505",
"14.4528492,79.9918247",
"14.4532684,79.9932228",
"14.4510366,79.9914752",
"14.4536429,79.9935723",
"14.4544365,79.9953198",
"14.4533727,79.9956693",
"14.4535684,79.9918247",
"14.4510366,79.9914752",
"14.4517239,79.9991642",
"14.4494303,80.0044064",
"14.455694,79.9995137",
"14.4494303,80.0044064",
"14.4547788,80.0013878",
"14.454588,80.0019902"
        ];

        tripPath = new google.maps.Polyline({
            geodesic: true,
            strokeColor: 'red',
            strokeOpacity: 1.0,
            strokeWeight: 2
        });

        endMarker = new google.maps.Marker({
            //position: new google.maps.LatLng(tourPlan[tourPlan.length - 1].split(',')[0],                                            tourPlan[tourPlan.length - 1].split(',')[1]),
            /*icon: {
                path: car,
                //url: 'img/map-marker-icon-red.png',
                scaledSize: new google.maps.Size(25, 30), // size
                origin: new google.maps.Point(0, 0), // origin
                anchor: new google.maps.Point(10, 25), // anchor
                fillColor: "teal",
                fillOpacity: 1,
            },*/
            draggable: false,
            map: map
        });

        //debugger;
        tripPath.setMap(map);
        
        route = function(){
            //debugger;
            if(flag == 1){
                if(i == tourPlan.length){
                    i = 0;
                    path = [];
                    tripPath.setPath(path);
                    endMarker.setPosition(null);
                    endMarker.setIcon(null);
                }
                else {
                    //debugger;
                    var myLatLng = new google.maps.LatLng(tourPlan[i].split(',')[0], tourPlan[i].split(',')[1]);
                    if (i > 0)
                    {
                        prevLatLng = new google.maps.LatLng(tourPlan[i - 1].split(',')[0], tourPlan[i - 1].split(',')[1]);
                        rotation = google.maps.geometry.spherical.computeHeading(prevLatLng, myLatLng);
                    }

                    var markerRed = {
                        path: car,
                        //url: 'img/map-marker-icon-red.png',
                        scaledSize: new google.maps.Size(25, 30), // size
                        origin: new google.maps.Point(0, 0), // origin
                        anchor: new google.maps.Point(10, 25), // anchor
                        fillColor: "red",
                        fillOpacity: 1,
                        rotation: rotation,
                        scale: .5
                    };
                    
                    var markerGreen = {
                        path: car,
                        //url: 'img/map-marker-icon-red.png',
                        scaledSize: new google.maps.Size(25, 30), // size
                        origin: new google.maps.Point(0, 0), // origin
                        anchor: new google.maps.Point(10, 25), // anchor
                        fillColor: "teal",
                        fillOpacity: 1,
                        rotation: rotation,
                        scale: .5
                    };

                    path.push(new google.maps.LatLng(tourPlan[i].split(',')[0], tourPlan[i].split(',')[1]));

                    tripPath.setPath(path);
                    endMarker.setPosition(myLatLng);
                    endMarker.setIcon(markerRed);
                    
                    

                    i = parseInt(i) + 1;
                }
            }
        };

        $("#btnPlay").click(function(){
            flag = 1;
            $("#btnPlay").hide();
            $("#btnStop").show();
            setInterval(route, 1000);
        });
        $("#btnStop").click(function(){
            flag = 0;
            $("#btnPlay").show();
            $("#btnStop").hide();
            clearInterval(route);
        });
    }
    $(document).ready(function(){
        $("#btnStop").hide();
    });
</script>
